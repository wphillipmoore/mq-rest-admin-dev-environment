networks:
  mq-dev-net:

services:
  qm1:
    image: ${MQ_IMAGE:-icr.io/ibm-messaging/mq:latest}
    hostname: qm1
    networks:
      - mq-dev-net
    ports:
      - "${QM1_MQ_PORT:-1414}:1414"
      - "${QM1_REST_PORT:-9443}:9443"
    environment:
      LICENSE: accept
      MQ_QMGR_NAME: QM1
      MQ_ENABLE_EMBEDDED_WEB_SERVER: "true"
      MQ_ADMIN_PASSWORD: mqadmin
      MQ_READER_PASSWORD: mqreader
    volumes:
      - qm1data:/var/mqm
      - ./mqwebuser.xml:/etc/mqm/web/installations/Installation1/servers/mqweb/mqwebuser.xml:ro
    healthcheck:
      test: ["CMD", "dspmq", "-m", "QM1"]
      interval: 10s
      timeout: 5s
      retries: 12

  qm2:
    image: ${MQ_IMAGE:-icr.io/ibm-messaging/mq:latest}
    hostname: qm2
    networks:
      - mq-dev-net
    ports:
      - "${QM2_MQ_PORT:-1415}:1414"
      - "${QM2_REST_PORT:-9444}:9443"
    environment:
      LICENSE: accept
      MQ_QMGR_NAME: QM2
      MQ_ENABLE_EMBEDDED_WEB_SERVER: "true"
      MQ_ADMIN_PASSWORD: mqadmin
      MQ_READER_PASSWORD: mqreader
    volumes:
      - qm2data:/var/mqm
      - ./mqwebuser.xml:/etc/mqm/web/installations/Installation1/servers/mqweb/mqwebuser.xml:ro
    healthcheck:
      test: ["CMD", "dspmq", "-m", "QM2"]
      interval: 10s
      timeout: 5s
      retries: 12

volumes:
  qm1data:
  qm2data:
